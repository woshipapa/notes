# 硬布线控制器

微命令对应微操作，一个机器周期下包含多个节拍，通常要访存的机器周期中含的节拍数会更多，

定长的机器周期会按照最长的机器周期来，同时一个节拍下可能会执行几个**互不相容的微操作**。

当明确了指令的操作码，当前处于哪个机器周期，处于哪个节拍，以及机器状态（比如PSW状态寄存器中的信息）就可以发出**微命令**了

FE,IND,EX,INT这四个触发器可以判断目前处于哪个机器周期中

![image-20230525125516243](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230525125516243.png)

OP（IR）将指令的操作码部分交给译码器，然后译码器的某个输出高电平说明是某个操作，比如ADD之类的操作。

节拍发生器这几个节拍是循环的，从头到尾再回头，T0,T1...



![image-20230525131525806](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230525131525806.png)

每一个微操作的微命令是要有逻辑表达式设计的电路发出的。

要把所有指令的不同机器周期的所有微操作序列写出来，然后把一个机器周期内的微操作序列安排到它的几个节拍内，当然首先要确定是定长的机器周期还是不定长的机器周期模式。

![image-20230525140054456](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230525140054456.png)

安排微操作时序：就是把一个机器周期内的微操作系列安排到几个节拍中去，有的不相容互不相干的微操作可以安排到一个节拍中去。

这里安排次序就是要注意：

1.操作的先后次序（依赖关系）

2.被控对象不同（一个是主存，一个寄存器）的微操作可以安排到同一个节拍中去

3.不需要访存的，只是数据在CPU的部件内传输的耗时短，可以安排在一个节拍内，就是这俩个微操作之间可能是有先后关系的但是不涉及访存就可以放到一个节拍里。

![image-20230525140245719](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230525140245719.png)

就是把之前所有指令在不同的机器周期下已经在每个节拍排好顺序的微操作（表中每个节拍的微操作是所有指令在该节拍下微操作的并集），。

根据这个表就可以确定一个微操作指令的逻辑表达式来设计电路了。

![image-20230525143402062](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230525143402062.png)

==注意：==

取完指令需要去取操作数的，在指令中指明了主存地址或者偏移地址的，PC+1完之后就指向了这个字。

![image-20230526230852513](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230526230852513.png)

![image-20230616110220653](C:\Users\papa\AppData\Roaming\Typora\typora-user-images\image-20230616110220653.png)
